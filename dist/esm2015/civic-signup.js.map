{
  "version": 3,
  "file": "civic-signup.js",
  "sources": [
    "ng://civic-signup/out/src/app/modules/civic/civic.module.ts",
    "ng://civic-signup/out/src/app/modules/civic/civic.component.ts",
    "ng://civic-signup/out/src/app/modules/civic/civic-signup.service.ts"
  ],
  "sourcesContent": [
    "import { NgModule ,ModuleWithProviders} from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { CivicComponent } from './civic.component';\r\nimport {CivicSignupService} from './civic-signup.service';\r\nimport { BehaviorSubject } from 'rxjs/BehaviorSubject';\r\n\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    \r\n    \r\n  ],\r\n  providers: [CivicSignupService],\r\n  declarations: [CivicComponent],\r\n  exports:[\r\n    CivicComponent\r\n    ],\r\n  bootstrap:[\r\n    CivicComponent\r\n  ]\r\n})\r\nexport class CivicModule { \r\n  static forRoot(): ModuleWithProviders {\r\n    return {\r\n      ngModule: CivicModule,\r\n      providers: [ CivicSignupService ]\r\n    };\r\n  }\r\n}\r\n",
    "import { Component, OnInit, ElementRef } from '@angular/core';\r\nimport { environment } from '../../../environments/environment.prod';\r\nimport { CivicSignupService } from './civic-signup.service';\r\ndeclare var civic:any;\r\ndeclare var window:any;\r\n\r\n@Component({\r\n  selector: 'app-civic',\r\n  template: `\r\n\r\n\r\n<button id=\"signupButton\" [ngClass]=\"currentClasses\" type=\"button\" (click)=\"sendSignUpRequest()\">\r\n  <span>{{buttonText}}</span>\r\n</button>`,\r\n  styles: [``]\r\n})\r\nexport class CivicComponent implements OnInit {\r\n\r\n  civicSip:any;\r\n  jwtToken:any;\r\n  flag:number;\r\n  Id:string;\r\n  buttonText:string;//=environment.buttonName;\r\n  error:any;\r\n  defaultStyle:boolean;\r\n  /*\r\n  flag index:\r\n  1 auth-code-recieved\r\n  2 user-cancelled\r\n  3 read\r\n  4 error\r\n  after sending sign-up request using \"sendSignUpRequest()\" analyse flag\r\n  retrieve jwtToken by using  getJwtToken() method\r\n  get the error by using getError() method\r\n  Use the attribute default in your app-civic reference tag if you want to use default civic style button,Ensure that you have the css file in your main html file\r\n  otherwise you can style it using the id that is 'signupButton'\r\n  \r\n  */    \r\n currentClasses: {};\r\n setCurrentClasses() {\r\n   // CSS classes: added/removed per current state of component properties\r\n   this.currentClasses =  {\r\n     'civic-button-a': this.defaultStyle,\r\n     'medium': this.defaultStyle\r\n    \r\n   };\r\n }\r\n\r\n  constructor(x:ElementRef,private data:CivicSignupService) {\r\n    this.flag=-1;\r\n    this.data.updateFlag(this.flag);\r\n\r\n   this.Id= x.nativeElement.getAttribute('appId');\r\n   this.buttonText=x.nativeElement.getAttribute('buttonLabel'); \r\n   this.defaultStyle=x.nativeElement.hasAttribute('default');\r\n   }\r\n\r\n  ngOnInit() {\r\n    this.civicSip=new civic.sip({appId:this.Id});\r\n    this.setCurrentClasses();\r\n    this.data.init(this);\r\n    window.buffer_service=this.data;\r\n\r\n  }\r\n  updateFlag(){\r\n    this.flag=window.buffer_flag;\r\n  }\r\n  sendSignUpRequest():number{\r\n    \r\n    this.civicSip.signup({ style: 'popup', scopeRequest: this.civicSip.ScopeRequests.BASIC_SIGNUP });\r\n    this.civicSip.on('auth-code-received', function (event) {\r\n     \r\n      // encoded JWT Token is sent to the server\r\n     this.jwtToken = event.response;\r\n     window.buffer_flag=1;\r\n     window.buffer_jwt=this.jwtToken;\r\n     window.buffer_service.updateFlag(1);\r\n     console.log(this.jwtToken);\r\n    });\r\n  \r\n    this.civicSip.on('user-cancelled', function (event) {\r\n     console.log(\"user cancelled\");\r\n     window.buffer_flag=2;\r\n     window.buffer_service.updateFlag(2);\r\n\r\n     });\r\n  \r\n    this.civicSip.on('read', function (event) {\r\n     window.buffer_flag=3;\r\n     window.buffer_service.updateFlag(3);\r\n\r\n\r\n    });\r\n  \r\n    this.civicSip.on('civic-sip-error', function (err) {\r\n       window.buffer_flag=4;\r\n       window.buffer_error=err;\r\n       window.buffer_service.updateFlag(4);\r\n\r\n\r\n      });\r\n      \r\n      return 0;\r\n  }\r\n  getJwtToken():any{\r\n    this.jwtToken=window.buffer_jwt;\r\n    this.flag=window.buffer_flag;\r\n    if(this.flag==1){\r\n    return this.jwtToken;\r\n    }\r\n    else{\r\n      console.log(\"Error jwtToken not yet recieved\");\r\n      return null;\r\n\r\n    }\r\n  }\r\n\r\n  getError():any{\r\n    if(this.flag==4){\r\n      return this.error;\r\n\r\n    }\r\n    console.log(\"No errors while sending signup request..check flag number to find out more\");\r\n    return null;\r\n  }\r\n\r\n\r\n}\r\n",
    "import { Injectable } from '@angular/core';\r\nimport {CivicComponent} from './civic.component';\r\nimport { BehaviorSubject } from 'rxjs/BehaviorSubject';\r\nimport { Observable } from 'rxjs/Observable';\r\n\r\n@Injectable()\r\nexport class CivicSignupService {\r\n  private civicObject:CivicComponent;\r\n  private flagSource=new BehaviorSubject<number>(-1);\r\n  currentFlag=this.flagSource.asObservable();\r\n  constructor() { }\r\n\r\n  init(x:CivicComponent){\r\n    this.civicObject=x;\r\n  }\r\n//this flag is observable and the changes in flag should be visible in real time to comsumer component\r\n  updateFlag(n:number){\r\n    console.log('updating flag ' +n);\r\n    this.flagSource.next(n);\r\n  }\r\n\r\n  getJwtToken():string{\r\n    \r\n    this.civicObject.updateFlag();\r\n    return this.civicObject.getJwtToken();\r\n  }\r\n  getSignupObject():CivicComponent{\r\n    this.civicObject.updateFlag();\r\n    return this.civicObject;\r\n  }\r\n\r\n  getError():any{\r\n    this.civicObject.updateFlag();\r\n    return this.civicObject.getError();\r\n  }\r\n  getFlag():any{\r\n    this.civicObject.updateFlag();\r\n    return this.civicObject.flag;\r\n  }\r\n}\r\n"
  ],
  "names": [],
  "mappings": ";;;;;;;;AEAA,AAMA,MAAA,kBAAA,CAAA;IAIE,WAAF,GAAA;QAFA,IAAA,CAAA,UAAA,GAAqB,IAAI,eAAe,CAAS,CAAC,CAAC,CAAC,CAApD;QACA,IAAA,CAAA,WAAA,GAAc,IAAI,CAAC,UAAU,CAAC,YAAY,EAAE,CAA5C;KACmB;;;;;IAEjB,IAAI,CAAC,CAAgB,EAAvB;QACI,IAAI,CAAC,WAAW,GAAC,CAAC,CAAC;KACpB;;;;;IAED,UAAU,CAAC,CAAQ,EAArB;QACI,OAAO,CAAC,GAAG,CAAC,gBAAgB,GAAE,CAAC,CAAC,CAAC;QACjC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;KACzB;;;;IAED,WAAW,GAAb;QAEI,IAAI,CAAC,WAAW,CAAC,UAAU,EAAE,CAAC;QAC9B,OAAO,IAAI,CAAC,WAAW,CAAC,WAAW,EAAE,CAAC;KACvC;;;;IACD,eAAe,GAAjB;QACI,IAAI,CAAC,WAAW,CAAC,UAAU,EAAE,CAAC;QAC9B,OAAO,IAAI,CAAC,WAAW,CAAC;KACzB;;;;IAED,QAAQ,GAAV;QACI,IAAI,CAAC,WAAW,CAAC,UAAU,EAAE,CAAC;QAC9B,OAAO,IAAI,CAAC,WAAW,CAAC,QAAQ,EAAE,CAAC;KACpC;;;;IACD,OAAO,GAAT;QACI,IAAI,CAAC,WAAW,CAAC,UAAU,EAAE,CAAC;QAC9B,OAAO,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC;KAC9B;;;IAjCH,EAAA,IAAA,EAAC,UAAU,EAAX;;;;;;;;;ADLA,AAgBA,MAAA,cAAA,CAAA;;;;;IAgCE,WAAF,CAAc,CAAY,EAAS,IAAuB,EAA1D;QAAmC,IAAnC,CAAA,IAAuC,GAAJ,IAAI,CAAmB;QACtD,IAAI,CAAC,IAAI,GAAC,CAAC,CAAC,CAAC;QACb,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAEjC,IAAI,CAAC,EAAE,GAAE,CAAC,CAAC,aAAa,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;QAC/C,IAAI,CAAC,UAAU,GAAC,CAAC,CAAC,aAAa,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC;QAC5D,IAAI,CAAC,YAAY,GAAC,CAAC,CAAC,aAAa,CAAC,YAAY,CAAC,SAAS,CAAC,CAAC;KACzD;;;;IAhBH,iBAAiB,GAAlB;;QAEG,IAAI,CAAC,cAAc,GAAI;YACrB,gBAAgB,EAAE,IAAI,CAAC,YAAY;YACnC,QAAQ,EAAE,IAAI,CAAC,YAAY;SAE5B,CAAC;KACH;;;;IAWA,QAAQ,GAAV;QACI,IAAI,CAAC,QAAQ,GAAC,IAAI,KAAK,CAAC,GAAG,CAAC,EAAC,KAAK,EAAC,IAAI,CAAC,EAAE,EAAC,CAAC,CAAC;QAC7C,IAAI,CAAC,iBAAiB,EAAE,CAAC;QACzB,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACrB,MAAM,CAAC,cAAc,GAAC,IAAI,CAAC,IAAI,CAAC;KAEjC;;;;IACD,UAAU,GAAZ;QACI,IAAI,CAAC,IAAI,GAAC,MAAM,CAAC,WAAW,CAAC;KAC9B;;;;IACD,iBAAiB,GAAnB;QAEI,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,KAAK,EAAE,OAAO,EAAE,YAAY,EAAE,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,YAAY,EAAE,CAAC,CAAC;QACjG,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,oBAAoB,EAAE,UAAU,KAAK,EAA1D;;YAGK,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC;YAC/B,MAAM,CAAC,WAAW,GAAC,CAAC,CAAC;YACrB,MAAM,CAAC,UAAU,GAAC,IAAI,CAAC,QAAQ,CAAC;YAChC,MAAM,CAAC,cAAc,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;YACpC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SAC3B,CAAC,CAAC;QAEH,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,gBAAgB,EAAE,UAAU,KAAK,EAAtD;YACK,OAAO,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;YAC9B,MAAM,CAAC,WAAW,GAAC,CAAC,CAAC;YACrB,MAAM,CAAC,cAAc,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;SAEnC,CAAC,CAAC;QAEJ,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,MAAM,EAAE,UAAU,KAAK,EAA5C;YACK,MAAM,CAAC,WAAW,GAAC,CAAC,CAAC;YACrB,MAAM,CAAC,cAAc,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;SAGpC,CAAC,CAAC;QAEH,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,iBAAiB,EAAE,UAAU,GAAG,EAArD;YACO,MAAM,CAAC,WAAW,GAAC,CAAC,CAAC;YACrB,MAAM,CAAC,YAAY,GAAC,GAAG,CAAC;YACxB,MAAM,CAAC,cAAc,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;SAGpC,CAAC,CAAC;QAEH,OAAO,CAAC,CAAC;KACZ;;;;IACD,WAAW,GAAb;QACI,IAAI,CAAC,QAAQ,GAAC,MAAM,CAAC,UAAU,CAAC;QAChC,IAAI,CAAC,IAAI,GAAC,MAAM,CAAC,WAAW,CAAC;QAC7B,IAAG,IAAI,CAAC,IAAI,IAAE,CAAC,EAAC;YAChB,OAAO,IAAI,CAAC,QAAQ,CAAC;SACpB;aACG;YACF,OAAO,CAAC,GAAG,CAAC,iCAAiC,CAAC,CAAC;YAC/C,OAAO,IAAI,CAAC;SAEb;KACF;;;;IAED,QAAQ,GAAV;QACI,IAAG,IAAI,CAAC,IAAI,IAAE,CAAC,EAAC;YACd,OAAO,IAAI,CAAC,KAAK,CAAC;SAEnB;QACD,OAAO,CAAC,GAAG,CAAC,4EAA4E,CAAC,CAAC;QAC1F,OAAO,IAAI,CAAC;KACb;;;IAtHH,EAAA,IAAA,EAAC,SAAS,EAAV,IAAA,EAAA,CAAW;gBACT,QAAQ,EAAE,WAAW;gBACrB,QAAQ,EAAE,CAAZ;;;SAKA,CAAU;gBACR,MAAM,EAAE,CAAC,CAAX,CAAa,CAAC;aACb,EAAD,EAAA;;;;IAfA,EAAA,IAAA,EAA4B,UAAU,GAAtC;IAEA,EAAA,IAAA,EAAS,kBAAkB,GAA3B;;;;;;;ADFA,AAsBA,MAAA,WAAA,CAAA;;;;IACE,OAAO,OAAO,GAAhB;QACI,OAAO;YACL,QAAQ,EAAE,WAAW;YACrB,SAAS,EAAE,CAAE,kBAAkB,CAAE;SAClC,CAAC;KACH;;;IArBH,EAAA,IAAA,EAAC,QAAQ,EAAT,IAAA,EAAA,CAAU;gBACR,OAAO,EAAE;oBACP,YAAY;iBAGb;gBACD,SAAS,EAAE,CAAC,kBAAkB,CAAC;gBAC/B,YAAY,EAAE,CAAC,cAAc,CAAC;gBAC9B,OAAO,EAAC;oBACN,cAAc;iBACb;gBACH,SAAS,EAAC;oBACR,cAAc;iBACf;aACF,EAAD,EAAA;;;;;;;;;;;;;;;;;;;;"
}
